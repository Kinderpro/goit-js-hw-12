{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/main.js"],"sourcesContent":["export function creatMarkup(arr) {\n    return arr\n      .map(\n        ({\n          webformatURL,\n          largeImageURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        }) => `<li class=\"card\">\n        <a href=\"${largeImageURL}\"><img class=\"img-card\" src=\"${webformatURL}\" alt=\"${tags}\" title=\"${tags}\" ></a>\n        <div class=\"description\"><p>Likes: ${likes}</p> <p>Views: ${views}</p>\n        <p>Comments: ${comments}</p>\n        <p>Downloads: ${downloads}</p></li>\n   </div>`\n      )\n      .join('');\n\n  }","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { creatMarkup } from './js/render-functions.js';\n// import { searchServiceImg } from './js/pixabay-api.js';\nimport axios from 'axios';\n\nlet page;\nlet per_page = 15;\nlet totalHits = 1;\n\nconst key = '42801696-74e6805803c5f99662f25fde0';\nlet elem = document.querySelector('ul');\nconst refs = {\n  formEl: document.querySelector('.form-search'),\n  gallery: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  readMore: document.querySelector('.read-more'),\n};\n\nrefs.formEl.addEventListener('submit', onSearchImg);\n\nasync function onSearchImg(evt) {\n  evt.preventDefault();\n  page = 1;\n  refs.readMore.classList.add('loader-none');\n  const nameSearch = evt.target[0].value;\n  localStorage.setItem('nameImg', JSON.stringify(nameSearch));\n  const nameImgGet = localStorage.getItem('nameImg');\n  const imgSear = JSON.parse(nameImgGet);\n  refs.loader.classList.remove('loader-none');\n\n  refs.gallery.innerHTML = '';\n  await searchServiceImg(imgSear)\n    .then(data => {\n      if (creatMarkup(data.hits) == []) {\n        refs.loader.classList.add('loader-none');\n        refs.readMore.classList.add('loader-none');\n        iziToast.error({\n          title: 'Error',\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n          position: 'topCenter',\n        });\n        this.reset();\n      } else {\n        refs.readMore.addEventListener('click', onClickReadMore);\n        refs.loader.classList.add('loader-none');\n        refs.readMore.classList.remove('loader-none');\n        refs.gallery.innerHTML = creatMarkup(data.hits);\n        lightbox.refresh();\n\n        this.reset();\n      }\n    })\n    .catch(er => {\n      refs.loader.classList.add('loader-none');\n      console.log(er);\n    });\n}\n\nasync function onClickReadMore() {\n  const nameInput = JSON.parse(localStorage.getItem('nameImg'));\n  //   const nameInput = refs.formEl.elements[0].value;\n  refs.loader.classList.remove('loader-none');\n  refs.readMore.classList.add('loader-none');\n  page += 1;\n\n  await searchServiceImg(nameInput)\n    .then(data => {\n      refs.gallery.insertAdjacentHTML('beforeend', creatMarkup(data.hits));\n      let rect = elem.getBoundingClientRect();\n      window.scrollBy({\n        top: rect.bottom * 2,\n        left: rect.x * 2,\n        behavior: 'smooth',\n      });\n      refs.loader.classList.add('loader-none');\n      lightbox.refresh();\n      refs.readMore.classList.remove('loader-none');\n      const totalPage = Math.ceil(data.totalHits / per_page);\n      if (page >= totalPage) {\n        refs.readMore.classList.add('loader-none');\n        iziToast.info({\n          title: 'Info',\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topCenter',\n        });\n      }\n    })\n    .catch(er => {\n      console.log(er);\n    });\n}\n\nlet lightbox = new SimpleLightbox('.gallery a', {\n  animationSpeed: 1000,\n  captionDelay: 250,\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionText: 'description',\n  history: false,\n  swipeClose: true,\n  close: true,\n});\n\nasync function searchServiceImg(imgSear) {\n  const BASE_URL = 'https://pixabay.com/api/';\n  const params = new URLSearchParams({\n    key,\n    q: imgSear,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: page,\n    per_page: per_page,\n  });\n\n  try {\n    const response = await axios.get(`${BASE_URL}?${params}`);\n    return response.data;\n  } catch (error) {\n    console.error(error);\n  }\n}\n"],"names":["creatMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","page","per_page","key","elem","refs","onSearchImg","evt","nameSearch","nameImgGet","imgSear","searchServiceImg","data","iziToast","onClickReadMore","lightbox","er","nameInput","rect","totalPage","SimpleLightbox","BASE_URL","params","axios","error"],"mappings":"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"}